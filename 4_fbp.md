# Потоко-Ориентированное Программирование

Форма Dataflow, созданная в ранних 1970х Дж. Полом Моррисоном. Проверенная годами и подарившая миру много других реализаций.

Это асинхронная форма dataflow с множественными портами и составными узлами. В FBP токен называется _информационным пакетом_ (IP). _IP_ может иметь одного _владельца_ и должен быть явно уничтожен или передан дальше. Сборки мусора нет.

В отличии от большинства других dataflow версий FBP позволяет объединять пакеты в списки и _деревья_ и работать с ними как с одиночными. Есть специальные IP _скобки_ символизирующие _подпотоки_ IP. Это упрощает сохранение структуры данных, покуда те текут сквозь программу. Также есть _IIP_ - как обычные пакеты, только посылаются в узел первым делом, чтобы помочь ему с конфигурацией. Есть несколько _состояний_ узла:

- Не инициализирован
- Завершил выполнение
- Активен
    - Просто активен
    - Приостановлен
- Не активен - не активирован, но и не завершён

Узел _завершён_ (terminated) когда его все его родительские (upstream) узлы завершены. Узлы могут решить завершиться и сами. Когда все узлы завершены, программа также завершена.

FBP даёт узлам больше контроля над исполнением чем любая другая форма dataflow. Обрабатывать множество IP за активацию или делать это по одному - всё это решает узел.

Узлы активируются по правилу `ANY` - когда узел находится в _неактивном_ состоянии, токен, пришедший в любой из портов вызывает его активацию. Будучи активирован, узел может ожидать одно событие за раз, будь то таймер, IO запрос или отложенное получение или отправка.

Каждый FBP узел имеет _автоматический входной порт_ и _автоматический выходной порт_ для кординации активации между узлами. Узел активирован когда такой входной порт получает пакет. Когда же узел завершён, если автоматический выходной порт подключен, то он закроет его для сигнализации остальным узлам, которые подключены к нему.

FBP утилизирует оба визуальное и текстовое представление. Текстовая форма варьируется от одной реализации к другой но в общем и целом это графовый DSL. 

## Возможности dataflow

- Асинхронная активация
- Статичная структура
- Push
- Соединение дуг есть, разделения нет
- Неизменяемость данных не обязательна, но приветствуется
- У узлов есть состояние
- И множественные порты
- ANY паттерн активации
- Циклы разрешены
- Рекурсия нет
- Составные ноды есть
- Вместимость дуги: фиксированна и как правило > 1
- Множественная обработка токенов за активацию допустима

## Преимущества FBP

Одна из немногих действительно прошедших проверку временем форм Dataflow, применяется как минимум с 1977. Есть множество реализаций. Создатель парадигмы написал книгу, которая может дать хороший толчок к понимаю FBP. FBP использует прагматичный подход, давая программисту большой контроль над тем, как работают узлы, а возможность группировать токены в структуры это мощная возможность, крайне редко встречающаяся в dataflow системах. Таким образом, FBP является крайне желательным выбором, если только нет какой-то важной возможности, которой оно не даёт. 